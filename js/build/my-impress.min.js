/*! my-impress 17-03-2014 */
$(function(){"use strict";window.addEventListener("impress:stepenter",function(){$("#name.active h1").addClass("animated flipInY")}),window.addEventListener("impress:stepenter",function(){$("#name.past h1").removeClass("animated flipInY")}),window.addEventListener("impress:stepenter",function(){$("#hobbies.active h1").addClass("animated rubberBand")}),window.addEventListener("impress:stepenter",function(){$("#hobbies.past h1").removeClass("animated rubberBand")}),window.addEventListener("impress:stepenter",function(){$("#myMaze.active #mazeInstruction").addClass("animated bounceInRight")}),window.addEventListener("impress:stepenter",function(){$("#myMaze.past #mazeInstruction").removeClass("animated bounceInRight")}),window.addEventListener("impress:stepenter",function(){$("#myMaze.active #game").addClass("animated tada")}),window.addEventListener("impress:stepenter",function(){$("#myMaze.past #game").removeClass("animated tada")}),window.addEventListener("impress:stepenter",function(){$("#movies.active #slideTip").addClass("animated tada")}),window.addEventListener("impress:stepenter",function(){$("#movies.past #slideTip").removeClass("animated tada")}),window.addEventListener("impress:stepenter",function(){$("#chart1.active #life").addClass("animated tada")}),window.addEventListener("impress:stepenter",function(){$("#chart1.past #life").removeClass("animated tada")}),window.addEventListener("impress:stepenter",function(){$("#chart2.active #quick").addClass("animated rubberBand")}),window.addEventListener("impress:stepenter",function(){$("#chart2.past #quick").removeClass("animated rubberBand")}),window.addEventListener("impress:stepenter",function(){$("#chart2.active #simple").addClass("animated slideInLeft")}),window.addEventListener("impress:stepenter",function(){$("#chart2.past #simple").removeClass("animated slideInLeft")}),window.addEventListener("impress:stepenter",function(){$("#chart2.active #hard").addClass("animated slideInLeft")}),window.addEventListener("impress:stepenter",function(){$("#chart2.past #hard").removeClass("animated slideInLeft")}),$("#chart2 #quick").hover(function(){$(this).addClass("animated rubberBand")},function(){$(this).removeClass("animated rubberBand")}),window.addEventListener("impress:stepenter",function(){$("#belief.active h1").addClass("animated swing")}),window.addEventListener("impress:stepenter",function(){$("#belief.past h1").removeClass("animated swing")}),window.addEventListener("impress:stepenter",function(){$("#info.active h1").addClass("animated rubberBand")}),window.addEventListener("impress:stepenter",function(){$("#info.past h1").removeClass("animated rubberBand")}),$("#info li").hover(function(){$(this).addClass("animated tada")},function(){$(this).removeClass("animated tada")})}),$(document).ready(function(){"use strict";function a(){var a=parseFloat(o.style.marginLeft);o.style.marginLeft=a===s*(q-1)*-1?0:a-s+"px"}var b,c,d,e,f,g="",h=document.getElementById("sprite"),i=h.width,j=h.height,k=document.createElement("canvas");k.width=i,k.height=j;var l=k.getContext("2d");l.fillStyle="white",l.fillRect(0,0,i,j),l.drawImage(h,0,0,i,j);for(var m=l.getImageData(0,0,i,j),n=m.data,o=document.getElementById("ascii"),p=0;p<n.length;p+=4)b=n[p],c=n[p+1],d=n[p+2],e=.34*b+.5*c+.16*d,n[p]=n[p+1]=n[p+2]=e,f=e>250?" ":e>230?"`":e>200?":":e>175?"*":e>150?"+":e>125?"#":e>50?"W":"@",0!==p&&p/4%i===0&&(o.appendChild(document.createTextNode(g)),o.appendChild(document.createElement("br")),g=""),g+=f;var q=10,r=document.getElementById("asciiContainer"),s=parseInt(window.getComputedStyle(r).width)/q;r.style.width=s+"px",o.style.marginLeft="0",setInterval(a,100)}),$(document).ready(function(){"use strict";var a=impress();$(document).on("keydown",function(b){"27"===b.which&&a.goto("overview1")});var b={};b.id="#myChart1",b.data=[{value:10,color:"#F7464A"},{value:10,color:"#69bf97"},{value:10,color:"#f9f281"}],b.create=function(){new Chart($(b.id)[0].getContext("2d")).Doughnut(b.data)},b.clear=function(){$(b.id)[0].getContext("2d").clearRect(0,0,$(b.id)[0].width,$(b.id)[0].height)};var c={};c.id="#myChart2",c.data={labels:["吃饭","思考","睡觉","聚会","编程","游戏","运动"],datasets:[{fillColor:"rgba(40,114,149,0.5)",strokeColor:"rgba(40,114,149,1)",pointColor:"rgba(40,114,149,1)",pointStrokeColor:"#fff",data:[65,59,90,81,56,55,40]},{fillColor:"rgba(191,63,63,0.5)",strokeColor:"rgba(191,63,63,1)",pointColor:"rgba(191,63,63,1)",pointStrokeColor:"#fff",data:[28,68,30,29,96,27,80]}]},c.create=function(){new Chart($(c.id)[0].getContext("2d")).Radar(c.data,{scaleShowLabels:!1,pointLabelFontSize:18})},c.clear=function(){$(c.id)[0].getContext("2d").clearRect(0,0,$(c.id)[0].width,$(c.id)[0].height)},b.create(),c.create(),window.addEventListener("impress:stepenter",function(){$("#chart1").hasClass("active")&&(b.clear(),b.create()),$("#chart2").hasClass("active")&&(c.clear(),c.create())})}),$(document).ready(function(){"use strict";function a(){z=1,y={x:0,y:0},P=[];for(var a=0;H>a;a++)for(var e=0;H>e;e++)P.push({x:a,y:e});O=[],Q=[],R={},L={x:0,y:0},J=!1,K=!1,B=[],M=[],N=[],b(),c(),d(),B[y.x][y.y].visited=!0}function b(){for(n=0;H>n;n++){var a=[];for(o=0;H>o;o++){var b=[0,0,0,0],c=[1,1,1,1],d=n,e=o;0===n?b[3]=1:n===H-1&&(b[1]=1),0===o?b[0]=1:o===H-1&&(b[2]=1);var f=V.createNew(d,e,b,c);a.push(f)}B.push(a)}}function c(){for(D.clearRect(0,0,E,F),D.strokeStyle="gray",D.lineWidth=2,n=0;H>n;n++)for(o=0;H>o;o++)for(var a=0;4>a;a++)if(B[n][o].wall[a]){switch(a){case 0:p=o*G,q=n*G,r=p,s=q+G;break;case 1:p=o*G,q=n*G+G,r=p+G,s=q;break;case 2:p=o*G+G,q=n*G+G,r=p,s=q-G;break;case 3:p=o*G+G,q=n*G,r=p-G,s=q}D.beginPath(),D.moveTo(p,q),D.lineTo(r,s),D.stroke()}D.strokeStyle="black",D.lineWidth=5,D.strokeRect(0,0,E,F)}function d(a,b){var c=a?a:y;D.beginPath(),D.fillStyle=b?b:"#69bf97",D.arc((c.y+.5)*G,(c.x+.5)*G,G/3,2*Math.PI,!1),D.fill()}function e(a){var b=a?a:L;D.clearRect((b.y+.5)*G-G/3,(b.x+.5)*G-G/3,2*G/3,2*G/3)}function f(){I>z?(k(y),0!==x.length?(t=Math.floor(Math.random()*x.length),u=x[t].x,v=x[t].y,y.y>v?(B[y.x][y.y].wall[0]=0,B[u][v].wall[2]=0):y.x<u?(B[y.x][y.y].wall[1]=0,B[u][v].wall[3]=0):y.y<v?(B[y.x][y.y].wall[2]=0,B[u][v].wall[0]=0):y.x>u&&(B[y.x][y.y].wall[3]=0,B[u][v].wall[1]=0),M.push(B[y.x][y.y]),y.x=u,y.y=v,B[y.x][y.y].visited=!0,y.x===H-1&&y.y===H-1&&(N=M.slice(0,M.length),N.push(B[y.x][y.y])),z++):(0===M.length&&alert("error"),w=M.pop(),y.x=w.x,y.y=w.y)):(J=!0,K=!1,clearInterval(A)),c(),J&&(m(),y.x=0,y.y=0),d()}function g(){if(I>=z){t=Math.floor(2*Math.random());var a=S[T][t];0!==y.x&&3===a||y.x!==H-1&&1===a||0!==y.y&&0===a||y.y!==H-1&&2===a?j(y,a):(t=1-t,a=S[T][t],(0!==y.x&&3===a||y.x!==H-1&&1===a||0!==y.y&&0===a||y.y!==H-1&&2===a)&&j(y,a)),c(),y.y+=1,z+=1,y.y===H&&(y.y=0,y.x+=1)}else J=!0,K=!1,clearInterval(A);J&&(m(),y.x=0,y.y=0),d()}function h(){if(P.length>0){for(var a=Math.floor(Math.random()*P.length),b=P[a].x,e=P[a].y,f=Math.floor(4*Math.random());0===f&&0===e||1===f&&b===H-1||2===f&&e===H-1||3===f&&0===b;)f=Math.floor(4*Math.random());var g=b,h=e;switch(f){case 0:h-=1;break;case 1:g+=1;break;case 2:h+=1;break;case 3:g-=1}j({x:b,y:e},f);var k=B[g][h].collected;if(void 0!==k)B[b][e].collected=k,Q[k].push({x:b,y:e,collected:k}),P.splice(a,1);else{var l=Q.length;B[b][e].collected=l,B[g][h].collected=l;var n=[];n.push({x:b,y:e,collected:l}),n.push({x:g,y:h,collected:l}),Q.push(n),P.splice(a,1);for(var o=0;o<P.length;o++)P[o].x===g&&P[o].y===h&&(P.splice(o,1),o=P.length)}O.push({from:{x:b,y:e},to:{x:g,y:h}}),c(),i()}else if(Q.length>1){for(var p,q=Q[Q.length-1],r=[];0===r.length;){p=q[Math.floor(Math.random()*q.length)];for(var s=0;4>s;s++)switch(s){case 0:0!==p.y&&B[p.x][p.y-1].collected!==p.collected&&r.push(0);break;case 1:p.x!==H-1&&B[p.x+1][p.y].collected!==p.collected&&r.push(1);break;case 2:p.y!==H-1&&B[p.x][p.y+1].collected!==p.collected&&r.push(2);break;case 3:0!==p.x&&B[p.x-1][p.y].collected!==p.collected&&r.push(3)}}var t=r[Math.floor(Math.random()*r.length)],u=p.x,v=p.y;switch(t){case 0:v-=1;break;case 1:u+=1;break;case 2:v+=1;break;case 3:u-=1}j({x:p.x,y:p.y},t),O.push({from:{x:p.x,y:p.y},to:{x:u,y:v}});for(var w=B[u][v].collected,x=0;x<q.length;x++)Q[w].push({x:q[x].x,y:q[x].y,collected:w}),B[q[x].x][q[x].y].collected=w;Q.splice(Q.length-1,1),c(),i()}else 1===Q.length&&(J=!0,K=!1,clearInterval(A),c(),d(),m())}function i(){for(var a=O.slice(0,O.length);a.length>0;){var b=a.pop();D.beginPath(),D.strokeStyle="69bf97",D.lineWidth=G/5>=8?8:G/5,D.moveTo((b.from.y+.5)*G,(b.from.x+.5)*G),D.lineTo((b.to.y+.5)*G,(b.to.x+.5)*G),D.stroke()}}function j(a,b){switch(B[a.x][a.y].wall[b]=0,b){case 0:B[a.x][a.y-1].wall[2]=0;break;case 1:B[a.x+1][a.y].wall[3]=0;break;case 2:B[a.x][a.y+1].wall[0]=0;break;case 3:B[a.x-1][a.y].wall[1]=0}}function k(a){x=[];try{w=B[a.x-1][a.y],w.visited===!1&&w.visited===!1&&x.push({x:a.x-1,y:a.y})}catch(b){}try{w=B[a.x+1][a.y],w.visited===!1&&w.visited===!1&&x.push({x:a.x+1,y:a.y})}catch(b){}try{w=B[a.x][a.y-1],w.visited===!1&&w.visited===!1&&x.push({x:a.x,y:a.y-1})}catch(b){}try{w=B[a.x][a.y+1],w.visited===!1&&w.visited===!1&&x.push({x:a.x,y:a.y+1})}catch(b){}}function l(){if(0!==N.length){c();for(var a,b=N.slice(0,N.length);b.length>0;)a=b.shift(),d({x:a.x,y:a.y},"#61868c")}else console.log("empty")}function m(){D.fillStyle="#69bf97";var a=(H-1)*G;D.fillRect(a+2,a+2,G-4,G-4),d({x:H-1,y:H-1},"white")}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=$("#maze")[0],D=C.getContext("2d"),E=C.width,F=C.height,G=50,H=E/G,I=H*H,J=!1,K=!1,L={x:0,y:0};window.maze_g=B;var M=[],N=[],O=[],P=[],Q=[],R={},S={Northwest:[0,3],Northeast:[2,3],Southwest:[0,1],Southeast:[1,2]},T="Northwest",U=document.getElementById("algo"),V={createNew:function(a,b,c,d,e,f){var g={};return g.x=a||0,g.y=b||0,g.border=c||[0,0,0,0],g.wall=d||[0,0,0,0],g.solution=e||[0,0,0,0],g.backtrap=f||[0,0,0,0],g.visited=!1,g}};a(),$(document).keydown(function(b){if("#/myMaze"===window.location.hash)if(71===b.which){if(!J&&!K){U=document.getElementById("algo");for(var i=0;i<U.length;i++)if(U[i].checked){switch(U[i].value){case"DFS":A=setInterval(f,10);break;case"Kruskal":A=setInterval(h,10);break;case"BT":A=setInterval(g,10)}break}K=!0,d()}}else if(78===b.which)void 0!==A&&clearInterval(A),a();else if(83===b.which)J&&l();else if(72===b.which)c(),y.x=0,y.y=0,d(L),m();else if(J&&(74===b.which||73===b.which||76===b.which||75===b.which)){switch(b.which){case 74:0===B[L.x][L.y].wall[0]&&(e(),L.y-=1,c(),m(),d(L));break;case 73:0===B[L.x][L.y].wall[3]&&(e(),L.x-=1,c(),m(),d(L));break;case 76:0===B[L.x][L.y].wall[2]&&(e(),L.y+=1,c(),m(),d(L));break;case 75:0===B[L.x][L.y].wall[1]&&(e(),L.x+=1,c(),m(),d(L))}L.x===H-1&&L.y===H-1&&(J=!1,$("#mazeSuccess").fadeIn("slow"),setTimeout(function(){$("#mazeSuccess").fadeOut("slow")},3e3))}})});